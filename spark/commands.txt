-- create operators --

helm repo add stackable-stable https://repo.stackable.tech/repository/helm-stable/
helm repo update

kubectl create namespace stackable

helm install -n stackable commons-operator stackable-stable/commons-operator --version 23.7.0
helm install -n stackable secret-operator stackable-stable/secret-operator --version 23.7.0
helm install -n stackable spark-k8s-operator stackable-stable/spark-k8s-operator --version 23.7.0 --set webhdfs.enabled=true

-- create jobs --

kubectl apply -f spark-application.yaml -n stackable


-- clean up --

kubectl delete -f spark-application.yaml -n stackable

helm uninstall -n stackable commons-operator
helm uninstall -n stackable secret-operator
helm uninstall -n stackable spark-k8s-operator

kubectl delete namespace stackable
